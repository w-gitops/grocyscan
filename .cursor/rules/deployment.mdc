---
description: Remote server configuration and deployment methods
alwaysApply: true
---

# Deployment

## Environments

| Environment | URL | Server | Method |
|-------------|-----|--------|--------|
| Production | `https://grocyscan.ssiops.com` | `192.168.200.37` | Bare install (rsync + systemd) |
| Staging | `https://dev.grocyscan.ssiops.com` | Proxmox runner | Docker `:dev` (auto on push to `dev`) |
| Preview PR #N | `https://pr-N.preview.grocyscan.ssiops.com` | Proxmox runner | Docker `:pr-N` (auto on PR) |

## Deploy Methods

### 1. Smart Deploy (Recommended — works everywhere)
```bash
./scripts/cursor-deploy.sh deploy    # Auto-detects local vs cloud
./scripts/cursor-deploy.sh status    # Check CI/deployment status
./scripts/cursor-deploy.sh preview   # Get preview URL for current PR
```

### 2. Direct Deploy (Local network only — production server)
```bash
./scripts/deploy.sh                  # Full rsync + systemd deploy
./scripts/deploy.ps1                 # Windows equivalent
```

### 3. CI/CD Deploy (Automatic)
- **Preview**: Auto on PR create/update (Docker on Proxmox, HTTPS via NPM)
- **Staging**: Auto on push to `dev` (Docker on Proxmox)
- **Production**: Auto on push to `main` (rsync + systemd)
- See `.cursor/rules/cicd.mdc` for full documentation

## Production Server

```
Host: 192.168.200.37
User: root
SSH: root@192.168.200.37
Path: /opt/grocyscan
Service: grocyscan (systemd)
Port: 3334
```

### Common Commands

```bash
ssh root@192.168.200.37 "systemctl status grocyscan"
ssh root@192.168.200.37 "journalctl -u grocyscan -f"
ssh root@192.168.200.37 "systemctl restart grocyscan"
ssh root@192.168.200.37 "curl -s http://localhost:3334/health"

# CI status (works in cloud agents too)
gh run list --branch $(git rev-parse --abbrev-ref HEAD)
```
